<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Application Queue</title>
    </head>
  <body>

    <div id="root"></div>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="requestmaker.js"></script>
    <script src="scripts.js"></script>

    <script>

      const app = document.getElementById('root');
      const container = document.createElement('div');
      container.setAttribute('class', 'card-container container-fluid');
      let row = document.createElement('div');
      row.className = "row no-gutters";
      app.appendChild(container);
      container.appendChild(row);

      let application = controller("http://localhost:65072");
      let data = application.getStudentPrograms();
      let i = 0;

      const buttonEnqueue = document.createElement('a');
      buttonEnqueue.className = "btn btn-warning";
      buttonEnqueue.textContent = "Add program to queue";
      buttonEnqueue.addEventListener("click", function () {
      window.location.href = "enqueue.html";
      });
      
      container.appendChild(buttonEnqueue); 

      data.then((res)=>{
          res.forEach(element => {
              const column = document.createElement('div');
              column.className = "col col-sm-3 mb-3";
              const card = document.createElement('div');
              card.setAttribute('class', 'card'); 
              const body = document.createElement('body');
              body.className = "card-body";

              const h4 = document.createElement('h3');
              h4.textContent = "Team Name:";
              const h5 = document.createElement('h1');
              h5.textContent = element.teamName;
              h5.className = "card-title";
              
    
              const p = document.createElement('p');
              p.textContent = element.src;
              p.className = "card-text";
                
              const buttonGroup = document.createElement('div');
              buttonGroup.className = 'btn-group';
              const buttonEdit = document.createElement('a');
              buttonEdit.className = "btn btn-primary";
              buttonEdit.textContent = "Edit";
                
              var queryString = "?id=" + element.id;
              buttonEdit.addEventListener("click", function () {                 
                window.location.href = "edit.html" + queryString;
              });                

              const buttonInfo = document.createElement('a');
              buttonInfo.className = "btn btn-secondary";
              buttonInfo.textContent = "Details";
              buttonInfo.addEventListener("click", function () {
              window.location.href = "details.html" + queryString;
              });
                
              const buttonDelete = document.createElement('a');
              buttonDelete.className = "btn btn-danger";
              buttonDelete.textContent = "Delete";
              buttonDelete.addEventListener("click", () => {
              application.deleteStudentProgram(element.id);
              });

              row.appendChild(column);
              column.appendChild(card);
              card.appendChild(body);
              card.appendChild(h4);
              card.appendChild(h5);
              card.appendChild(p);
                
              card.appendChild(buttonGroup);
              buttonGroup.appendChild(buttonEdit);
              buttonGroup.appendChild(buttonInfo);
              buttonGroup.appendChild(buttonDelete);
              i++;
              if(i == 4){
                  const w = document.createElement('div');
                  w.className = "w-100";
                  row.appendChild(w);
                  i = 0;
              }                
          });
      });    
    </script>
  </body>
</html>